function switchTab(currentPos,switchTo){const tabs=document.querySelectorAll(".booking-tab");return switchTo>=tabs.length||switchTo<0?currentPos:(tabs[currentPos].classList.remove("active"),tabs[switchTo].classList.add("active"),changeActive(currentPos,switchTo),switchTo)}function changeActive(currentPos,switchTo){const tabControls=document.querySelectorAll(".booking-position button");tabControls[currentPos].classList.remove("active"),tabControls[switchTo].classList.add("active")}function updateDivers(noOfDivers,form,diverForm){const newFormGroup=document.querySelectorAll(".diver-form"),noOfForms=newFormGroup.length;let lastCount=newFormGroup[noOfForms-1].querySelector("span").innerText;if(noOfDivers>noOfForms){let difference=noOfDivers-noOfForms;for(i=0;i<difference;i++){let newForm=form.cloneNode(!0),newDiverForm=diverForm.cloneNode(!0),nav=form.querySelector(".form-nav");lastCount=parseInt(lastCount)+1,newForm.querySelector("span").innerText=""+lastCount,newDiverForm.querySelector(".disp-count").innerText=""+lastCount,form.insertBefore(newForm,nav),insertAfter(newDiverForm,diverForm)}}else if(noOfDivers<noOfForms)for(i=noOfDivers;i<noOfForms;i++)newFormGroup[i].remove();diverInputUpdate()}function submitFormAjax(form,action){let xmlhttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");xmlhttp.onreadystatechange=function(){4===this.readyState&&200===this.status&&(form.style.display="none",document.querySelector(".booking-final").classList.remove("d-none"))};let formData=new FormData(form);xmlhttp.open("POST",action,!0),xmlhttp.send(formData)}function serialize(form){for(var serialized=[],i=0;i<form.elements.length;i++){var field=form.elements[i];if(field.name&&!field.disabled&&"file"!==field.type&&"reset"!==field.type&&"submit"!==field.type&&"button"!==field.type)if("select-multiple"===field.type)for(var n=0;n<field.options.length;n++)field.options[n].selected&&serialized.push(encodeURIComponent(field.name)+"="+encodeURIComponent(field.options[n].value));else("checkbox"!==field.type&&"radio"!==field.type||field.checked)&&serialized.push(encodeURIComponent(field.name)+"="+encodeURIComponent(field.value))}return serialized.join("&")}function insertAfter(newNode,referenceNode){referenceNode.parentNode.insertBefore(newNode,referenceNode.nextSibling)}function diverInputUpdate(){const diverForm=document.querySelectorAll(".booking-divers input:not(.diver-air-ticket), .booking-divers select"),diverDisplay=document.querySelectorAll(".conf-divers span:not(.disp-count)"),imgInputs=document.querySelectorAll(".diver-air-ticket"),imgDisplays=document.querySelectorAll(".booking-air-ticket");for(let i=0;i<diverForm.length;i++)diverForm[i].addEventListener("input",()=>{diverDisplay[i].innerText=diverForm[i].value});for(let i=0;i<imgInputs.length;i++)imgInputs[i].addEventListener("change",e=>{preview_image(e,imgDisplays[i])})}function preview_image(event,placeHolder){var reader=new FileReader;reader.onload=function(){placeHolder.src=reader.result},reader.readAsDataURL(event.target.files[0])}window.addEventListener("load",()=>{let currentPos=0;const fullForm=document.querySelector(".booking-form"),tabControls=document.querySelectorAll(".booking-position button"),nextButtons=document.querySelectorAll("#booking-page .next"),prevButtons=document.querySelectorAll("#booking-page .prev"),basicForm=document.querySelectorAll(".booking-basic input"),basicDisplay=document.querySelectorAll(".conf-basic span"),diverFormGroup=document.querySelector(".diver-display-single"),diverCountInput=document.querySelector("#no-of-divers"),formGroup=document.querySelector(".diver-form"),submitBtn=fullForm.querySelector('input[type="submit"]');let formLink=fullForm.getAttribute("action");fullForm.removeAttribute("action"),tabControls.forEach(tabControl=>{tabControl.addEventListener("click",e=>{e.preventDefault();let switchTo=tabControl.getAttribute("data-switch");currentPos=switchTab(currentPos,switchTo)})}),nextButtons.forEach(nextBtn=>{nextBtn.addEventListener("click",e=>{e.preventDefault();let currentForm=document.querySelector(".booking-tab.active"),currentNav=currentForm.querySelector(".form-nav"),currentFormInputs=document.querySelectorAll(".booking-tab.active input"),isEmpty=!1;for(let i=0;i<currentFormInputs.length;i++)if(""===currentFormInputs[i].value&&currentFormInputs[i].hasAttribute("required")){let message=document.createElement("span");message.className="error",message.innerText="Looks like you left some fields empty!",currentForm.insertBefore(message,currentNav),isEmpty=!0;break}if(!isEmpty){let switchTo=parseInt(currentPos)+1;currentPos=switchTab(currentPos,switchTo)}})}),prevButtons.forEach(prevBtn=>{prevBtn.addEventListener("click",e=>{let switchTo;e.preventDefault(),currentPos=switchTab(currentPos,currentPos-1)})}),diverCountInput.addEventListener("input",e=>{e.preventDefault(),updateDivers(diverCountInput.value,formGroup,diverFormGroup)}),document.addEventListener("keypress",e=>{if("Enter"==e.key){let formsCount=document.querySelectorAll(".booking-tab").length;if(currentPos!==formsCount-1){console.log("not avail"),e.preventDefault();let switchTo=parseInt(currentPos)+1;currentPos=switchTab(currentPos,switchTo)}}});for(let i=0;i<basicForm.length;i++)basicForm[i].addEventListener("input",()=>{basicDisplay[i].innerText=basicForm[i].value});fullForm.addEventListener("submit",e=>{e.preventDefault(),submitFormAjax(fullForm,formLink)})});